[Unit]
Description=launch Local Browser Kiosk mode
After=network.target weston.service python-webserver.service
Requires=weston.service python-webserver.service

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi
PermissionsStartOnly=true
Restart=always

# Log us in via PAM so we get our XDG & co. environment and
# are treated as logged in so we can use the tty:
PAMName=login
Environment="WAYLAND_DISPLAY=wayland-0"
Environment="DISPLAY=:0"
# The `wheelDelta` parameter in the following line is platform and browser specific. Values of `53` (macOS, Chrome)
# and `120` (RPi OS, Chromium) have been observed. Adjust as necessary.
ExecStart=bash -c '(sleep 20; xdotool mousemove 100 100) & exec chromium-browser --remote-debugging-port=9222 --disable-gpu-blocklist --enable-gpu-rasterization --use-gl=desktop --kiosk --start-fullscreen --incognito --noerrdialogs --no-first-run --disk-cache-dir=/dev/null \'http://localhost:8080?wheel=true&wheelDelta=120\''

[Install]
WantedBy=multi-user.target

